<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Building Your Custom Path...</title>
    <meta name="description" content="We're analyzing your answers to build a personalized path to homeownership.">
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #003366;
            --secondary-color: #F57C00;
            --text-color: #333;
            --background-color: #f4f4f9;
            --light-gray: #e9e9e9;
            --white: #ffffff;
            --success-color: #2E7D32;
            --soft-glow: rgba(235, 244, 250, 0.8);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Montserrat', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            text-align: center;
            opacity: 0;
            transition: opacity 1s ease-in-out;
            padding: 2rem 1rem;
        }
        body::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: linear-gradient(-45deg, #EBF4FA, #f4f4f9, #EBF4FA, #f0f2f5);
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
            z-index: -1;
        }
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        body.loaded { opacity: 1; }
        .processing-container {
            background-color: var(--white);
            padding: 2.5rem 2rem;
            border-radius: 16px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.08);
            max-width: 640px;
            width: 100%;
            animation: fadeIn 1s ease-in-out;
            border: 1px solid rgba(0,0,0,0.05);
            border-top: 5px solid;
            border-image: linear-gradient(to right, var(--secondary-color), #ff983c) 1;
            position: relative;
            overflow: hidden;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #analysis-content {
            transition: filter 0.6s ease-out, opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        #analysis-content.is-blurred {
            filter: blur(8px);
            opacity: 0.5;
            transform: scale(0.98);
        }
        h1 { font-size: clamp(1.5rem, 5vw, 2rem); color: var(--primary-color); margin-bottom: 0.75rem; font-weight: 700; }
        h1 strong { color: var(--secondary-color); font-weight: 700; opacity: 0; animation: fadeIn 0.5s 0.5s ease-out forwards; }
        .intro-text { font-size: clamp(0.9rem, 2.5vw, 1rem); color: #555; margin-bottom: 2rem; max-width: 500px; margin-left: auto; margin-right: auto; }
        .personalization-summary { background-color: var(--soft-glow); border-radius: 8px; padding: 1rem; margin-bottom: 2rem; border-left: 4px solid var(--primary-color); text-align: left; opacity: 0; transform: scale(0.95); transition: opacity 0.5s ease-out, transform 0.5s ease-out; }
        .personalization-summary.visible { opacity: 1; transform: scale(1); }
        .personalization-summary p { font-size: 0.9rem; color: var(--text-color); font-weight: 500; margin: 0; }
        .personalization-summary p:first-child { margin-bottom: 0.5rem; }
        .personalization-summary strong { color: var(--primary-color); font-weight: 700; }
        .analysis-engine { display: flex; justify-content: space-around; align-items: flex-start; gap: 1rem; margin-bottom: 2rem; min-height: 100px; }
        .step-icon { display: flex; flex-direction: column; align-items: center; gap: 0.75rem; opacity: 0; width: 90px; transform: translateY(15px); animation: fadeInUp 0.6s cubic-bezier(0.25, 1, 0.5, 1) forwards; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        .step-icon .icon-wrapper { width: 50px; height: 50px; border-radius: 50%; background-color: var(--soft-glow); display: flex; justify-content: center; align-items: center; border: 2px solid var(--primary-color); transition: all 0.4s ease; }
        .step-icon svg { width: 28px; height: 28px; color: var(--primary-color); transition: all 0.4s ease; }
        .step-icon .label { font-size: 0.75rem; font-weight: 600; color: #777; transition: color 0.4s ease; line-height: 1.3; }
        .step-icon.completed .icon-wrapper { background-color: var(--success-color); border-color: var(--success-color); box-shadow: 0 0 15px rgba(46, 125, 50, 0.3); animation: checkmark-pop 0.4s ease-out; }
        @keyframes checkmark-pop { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .step-icon.completed svg { color: var(--white); }
        .step-icon.completed .label { color: var(--text-color); }
        .final-handoff { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 2rem; opacity: 0; transform: scale(1.05); transition: opacity 0.6s ease-out, transform 0.6s ease-out; pointer-events: none; }
        .final-handoff.visible { opacity: 1; transform: scale(1); pointer-events: auto; }
        .final-handoff.visible + .status-footer {
    display: none;
}
        .final-handoff h2 { font-size: clamp(1.4rem, 4vw, 1.8rem); color: var(--primary-color); margin-bottom: 0.5rem; font-weight: 700; }
        .final-handoff h2 strong { color: var(--secondary-color); }
        .final-handoff .subtitle { font-size: clamp(0.9rem, 2.5vw, 1.1rem); color: #555; margin-bottom: 1.5rem; max-width: 450px; }

        /* --- NEW CSS FOR THE OVERHAULED FINAL HANDOFF --- */
        .handoff-content {
            width: 100%;
            max-width: 480px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1.5rem;
        }
        .value-summary {
            background-color: var(--soft-glow);
            border-radius: 12px;
            padding: 1.25rem;
            width: 100%;
            text-align: center; /* Changed to center for modern appeal */
            border: 1px solid rgba(0, 51, 102, 0.1);
            position: relative;
            overflow: hidden;
        }
        .value-summary::before { /* Subtle top highlight */
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
        }
        .value-summary h4 {
            font-size: 1.1rem; /* Slightly larger */
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 0.75rem; /* Reduced margin */
            line-height: 1.4;
        }
        .value-summary p { /* This is the new persuasive privacy copy */
            font-size: 0.95rem; /* Adjusted for readability */
            color: #555;
            font-weight: 500;
            margin: 0;
            line-height: 1.6;
        }
        .value-summary p strong {
            color: var(--primary-color);
        }

        /* Removed ul, li styles as they are no longer needed for the new copy */
        /*
        .value-summary ul { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 0.75rem; }
        .value-summary li { font-size: 0.9rem; color: #333; font-weight: 500; display: flex; align-items: center; gap: 0.75rem; }
        .value-summary li svg { width: 20px; height: 20px; color: var(--success-color); flex-shrink: 0; }
        .value-summary li strong { color: var(--primary-color); }
        */

        
       /* --- FINAL CTA WITH SEXY DEPTH --- */
.cta-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    
    /* 1. THE LIGHTING: A very subtle gradient makes the button feel lit from above. */
    background: linear-gradient(to top, #E67E22, #F57C00); /* Darker orange rises to your brand orange */

    color: var(--white);
    font-size: 1.1rem;
    font-weight: 700;
    line-height: 1;
    padding: 1rem 2rem;
    border-radius: 8px;
    width: 100%;
    text-decoration: none;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    
    /* 2. THE FORM: A crisp bottom border gives it a defined, physical edge. */
    border: none;
    border-bottom: 2px solid rgba(0, 0, 0, 0.25);

    /* 3. THE FINISH: Layered shadows create a realistic, "pressable" look. */
    box-shadow: 
        /* The top "glint" of light on the edge */
        inset 0 1px 1px rgba(255, 255, 255, 0.2),
        /* The soft lift shadow */
        0 4px 12px rgba(0, 0, 0, 0.1);

    cursor: pointer;
    transition: all 0.2s ease-out;
}

.cta-button:hover {
    /* On hover, the light source appears brighter */
    background: linear-gradient(to top, #F39C12, #FF8C00);
    
    /* The button lifts up slightly */
    transform: translateY(-2px);

    /* The shadow expands for a "glow" effect */
    box-shadow: 
        inset 0 1px 2px rgba(255, 255, 255, 0.3),
        0 6px 16px rgba(0, 0, 0, 0.15);
}

.cta-button:active {
    /* 4. THE PRESS: This creates a satisfying "click" feedback. */
    transform: translateY(1px); /* Moves down into the page */
    background: linear-gradient(to top, #D35400, #E67E22); /* The button darkens */
    /* The shadow shrinks and the glint disappears, mimicking a pressed state */
    box-shadow: inset 0 2px 2px rgba(0, 0, 0, 0.2);
}

.button-lock-icon svg {
    width: 20px;
    height: 20px;
}
        .redirect-notice { font-size: 0.8rem; color: #888; margin-top: 0.5rem; }
        /* --- END NEW CSS --- */

        .status-footer { margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--light-gray); position: relative; }
        .final-handoff.visible + .status-footer {
    border-top: none;
}
        .status-message { font-weight: 600; font-size: 1rem; color: var(--primary-color); height: 2.5rem; transition: opacity 0.3s ease-in-out; text-align: center; display: flex; align-items: center; justify-content: center; }
        .progress-bar-container { width: 100%; height: 8px; background-color: var(--light-gray); border-radius: 4px; margin-top: 1rem; overflow: hidden; }
        .progress-bar { width: 0%; height: 100%; background-color: var(--success-color); border-radius: 4px; transition: width 1.2s cubic-bezier(0.25, 1, 0.5, 1); }
    </style>
</head>
<body>
    <div class="processing-container" id="processing-container">
        <div id="analysis-content">
            <h1 id="main-headline"><strong></strong></h1>
            <p class="intro-text"></p>
            <div class="personalization-summary" id="personalization-summary">
                <p id="obstacle-summary-line"><span>Analyzing solutions for <strong>your biggest obstacle</strong>...</span></p>
                <p id="fear-summary-line"><span>Addressing your concern about <strong>your biggest fear</strong>...</span></p>
            </div>
            <div class="analysis-engine">
                <div class="step-icon" id="step1"><div class="icon-wrapper"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.286zm0 13.036h.008v.008h-.008v-.008z" /></svg></div><span class="label">Encrypting Data</span></div>
                <div class="step-icon" id="step2"><div class="icon-wrapper" id="step2-icon"></div><span class="label" id="step2-label"></span></div>
                <div class="step-icon" id="step3"><div class="icon-wrapper" id="step3-icon"></div><span class="label" id="step3-label"></span></div>
            </div>
        </div>

        <div class="final-handoff" id="final-handoff-view">
            <h2 id="final-headline"></h2>
            <p class="subtitle" id="final-subtitle"></p>
            <div class="handoff-content">
                <div class="value-summary">
                    <h4>Your Privacy is Our Priority.</h4>
                    <p>For your privacy, a final confirmation on the **official results site** is required to instantly unlock your matches</p>
                </div>
                <a href="#" id="affiliate-link-button" class="cta-button">
                    <span class="button-text">Confirm & View Matches</span>
                    <span class="button-lock-icon"></span>
                </a>
                <p class="redirect-notice"></p>
            </div>
        </div>
        <div class="status-footer">
            <p class="status-message" id="status-message">Initializing...</p>
            <div class="progress-bar-container"><div class="progress-bar" id="progress-bar"></div></div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            document.body.classList.add('loaded');

            const params = new URLSearchParams(window.location.search);
            const firstName = params.get('firstName') || 'Friend';
            const fear = params.get('fear');
            const obstacle = params.get('obstacle');

            

            const obstacleMap = {
                'credit-score': { icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-3.75-2.25M21 18l-3.75-2.25" /></svg>', label: 'Credit Solutions', summary: 'your credit score' },
                'down-payment': { icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a2.25 2.25 0 00-2.25-2.25H15a3 3 0 11-6 0H5.25A2.25 2.25 0 003 12m18 0v6a2.25 2.25 0 01-2.25-2.25H5.25A2.25 2.25 0 013 18v-6m18 0V9M3 12V9m18 3a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 9m18 3V9" /></svg>', label: 'Payment Options', summary: 'a large down payment' },
                'self-doubt': { icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.182 15.182a4.5 4.5 0 01-6.364 0M21 12a9 9 0 11-18 0 9 9 0 0118 0zM9 9.562a1.5 1.5 0 013 0V10.5a1.5 1.5 0 01-3 0V9.562z" /></svg>', label: 'Building Confidence', summary: 'self-doubt' },
                'default': { icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" /></svg>', label: 'Analyzing Programs', summary: 'your unique situation' }
            };
            const fearMap = {
                'losing-money': { icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" /></svg>', label: 'Vetting Investments', summary: 'losing your money'},
                'complicated-contracts': { icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m5.231 13.5h3.832c.621 0 1.125-.504 1.125-1.125V6.108c0-.621-.504-1.125-1.125-1.125h-3.832M12 15.75h-1.5a1.125 1.125 0 01-1.125-1.125V6.108c0-.621.504-1.125 1.125-1.125h1.5m1.5 0h-1.5" /></svg>', label: 'Clarifying Terms', summary: 'complicated contracts'},
                'never-own': { icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" /></svg>', label: 'Securing Ownership', summary: 'never truly owning the home'},
                'default': { icon: '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>', label: 'Finding Matches', summary: 'potential concerns'}
            };
            
            const obstacleData = obstacleMap[obstacle] || obstacleMap.default;
            const fearData = fearMap[fear] || fearMap.default;

            document.querySelector('#obstacle-summary-line span').innerHTML = `Analyzing solutions for <strong>${obstacleData.summary}</strong>...`;
            document.querySelector('#fear-summary-line span').innerHTML = `Addressing your concern about <strong>${fearData.summary}</strong>...`;
            document.getElementById('step2-icon').innerHTML = obstacleData.icon;
            document.getElementById('step2-label').textContent = obstacleData.label;
            document.getElementById('step3-icon').innerHTML = fearData.icon;
            document.getElementById('step3-label').textContent = fearData.label;
            
            const analysisContent = document.getElementById('analysis-content');
            const finalHandoffView = document.getElementById('final-handoff-view');
            const finalHeadline = document.getElementById('final-headline');
            const finalSubtitle = document.getElementById('final-subtitle');
            const statusMessage = document.getElementById('status-message');
            const progressBar = document.getElementById('progress-bar');
            
            const updateStatusMessage = (newMessage) => {
                statusMessage.style.opacity = '0';
                setTimeout(() => {
                    statusMessage.textContent = newMessage;
                    statusMessage.style.opacity = '1';
                }, 200);
            };

            const steps = [
                { id: 'step1', delay: 1200, message: `Encrypting your data, ${firstName}...` },
                { id: 'step2', delay: 2400, message: "Cross-referencing programs..." },
                { id: 'step3', delay: 3600, message: "Finalizing your matches..." }
            ];

            // --- REVISED Animation Sequence ---
            steps.forEach((step, index) => {
                setTimeout(() => {
                    updateStatusMessage(step.message);

                    const stepElement = document.getElementById(step.id);
                    if (index === 0) {
                         document.getElementById('personalization-summary').classList.add('visible');
                    }
                    // Note: 'visible' class is not defined for step-icon in CSS, if needed, add it
                    stepElement.classList.add('visible'); 
                    
                    progressBar.style.width = `${((index + 1) / steps.length) * 100}%`;
                    
                    setTimeout(() => {
                        stepElement.classList.add('completed');
                    }, 800);

                }, step.delay); 
            });
            
            // --- REBUILT FINAL HANDOFF LOGIC ---
            setTimeout(() => {
                // 1. Update copywriting for the final screen
                finalHeadline.innerHTML = `<strong>${firstName}! </strong>`;
                

                // The value-summary content is now static in HTML, no dynamic list needed here
                
                // 2. Add the lock icon to the button
                const lockSVG = '<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" /></svg>';
                document.querySelector('.button-lock-icon').innerHTML = lockSVG;

                // 3. Blur the background and show the new handoff screen
                analysisContent.classList.add('is-blurred');
                finalHandoffView.classList.add('visible');
                updateStatusMessage("Connection established. Please continue.");

                // 4. Set up the affiliate link and click handler
                const affiliateURL = 'https://afflat3d3.com/trk/lnk/0E90180C-A4BF-4EB8-8A87-87589AF15D18/?o=8199&c=918277&a=667808&k=F9E327923C2A4BB4B7B50AE8A88D4091&l=6911';
                const affiliateButton = document.getElementById('affiliate-link-button');
                
                affiliateButton.href = affiliateURL;

                affiliateButton.addEventListener('click', function(e) {
                    this.style.animationPlayState = 'paused';
                    this.querySelector('.button-text').textContent = 'Redirecting...';
                });
                
                // Optional: Auto-redirect after a longer delay (e.g., 20 seconds) if the user doesn't click
                setTimeout(() => {
                    window.location.href = affiliateURL;
                }, 20000);

            }, 5200);
        });
    </script>
</body>
</html>